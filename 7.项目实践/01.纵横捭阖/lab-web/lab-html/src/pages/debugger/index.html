<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>调试神器</title>
  <link rel="stylesheet" href="./bpswitch-panel/style.css">
  <style>
    body {
      .body {
        display: flex;
        flex-wrap: wrap;
      }
    }

    .box {
      margin: 10px;

      .box-title {
        font-size: 16px;
        line-height: 22px;
        /* font-weight: 500; */
        color: #111;
        display: block;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        padding-left: 10px;
        border-left: 3px solid #7ed321;
        margin-bottom: 8px;
      }

      .box-subtitle {
        position: relative;
        width: 100%;
        font-size: 12px;
        color: #999999;
        word-wrap: break-word;
        margin: 5px 0;
        /* display: flex; */
      }

      &.bitmap-onoff {
        .area {
          /* border: 1px solid #ccc; */
          background: #f9ffff;
          border-radius: 5px;

          .settings {
            border-bottom: 1px solid #ccc;
            padding: 10px;
            font-size: 14px;

            .item {
              display: flex;
              align-items: center;
              margin-bottom: 10px;
              
              .bitmap-text {
                width: 450px;
              }

              input {
                height: 20px;
                margin-right: 10px;
              }
            }
          }

          .preview {
            padding: 10px;
          }
        }
      }
    }


  </style>
</head>

<body>
  <div class="body">

    <div class="box bitmap-onoff">
      <div class="box-title"><b>位图开关</b></div>
      <div class="box-subtitle">
        支持海量开关，数据类型支持数组或字符串(以逗号分隔)
        </span>
      </div>
      <div class="area" id="id-bitmap-switch-area">
        <div class="settings">
          <div class="item">
            开关值：<input class="bitmap-text" id="id-bitmap-text" type="text" value="2147483646,1,2,3,4,5,6,7,8,9,10" onchange="handleChangeBitmapPreview()">
            二进制长度：<input class="bitmap-binary" id="id-bitmap-binarylen" type="number" value="30" min="4" max="64" onchange="handleChangeBitmapPreview()">
          </div>
          <div class="item">
            第几位：<input class="bitmap-index" id="id-bitmap-index" type="text" value="22">
            <button onclick="handleClickQuery()">查询</button>
          </div>
        </div>
        <div class="preview" id="id-bitmap-preview">
          预览
        </div>
      </div>
    </div>

  </div>

  <script src="../../base/utils.js"></script>
  <script src="../../base/bpswitch.js"></script>
  <script src="./bpswitch-panel/index.js"></script>
  <script>
    _bitmapSwitchPanel = undefined;

    function handleChangeBitmapPreview() {
      const textElement = document.getElementById("id-bitmap-text");
      const binaryLenthElement = document.getElementById("id-bitmap-binarylen");
      const previewElement = document.getElementById("id-bitmap-preview");
      previewElement.innerHTML = "";
      // const text = elementText.value;
      // console.log('createBitmapPreview', textElement.value, binaryLenthElement.value);

      this._bitmapSwitchPanel = new BitmapSwitchPanel({
        value: textElement.value,
        binaryLenth: binaryLenthElement.value,
        target: previewElement,
        onChange: (data) => {
          console.log('onSwitchChange', data);
          const indexElement = document.getElementById("id-bitmap-text");
          indexElement.value = data.value;
          // this.handleChangeBitmapPreview();
        }
      });
    }

    function handleClickQuery() {
      const indexElement = document.getElementById("id-bitmap-index");
      this._bitmapSwitchPanel?.queryChecked(indexElement.value);
    }

    function main() {
      this.handleChangeBitmapPreview();
    }

    main();

  </script>
</body>

</html>